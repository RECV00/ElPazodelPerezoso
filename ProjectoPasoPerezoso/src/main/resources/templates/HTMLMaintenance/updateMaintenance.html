<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>
    <div th:fragment="updateModal">
        <!-- Modal para actualizar mantenimiento -->
        <div class="modal fade" id="updateMaintenanceModal" tabindex="-1" aria-labelledby="updateMaintenanceModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title" id="updateMaintenanceModalLabel">Actualizar Mantenimiento</h2>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <form method="post" th:action="@{/maintenance/updateM}" id="updateMaintenanceForm" class="needs-validation" novalidate>
                        <div class="modal-body">
                            <!-- Mensajes de alerta -->
                            <div th:if="${alertMessage}" class="alert" th:classappend="'alert-' + ${alertType}">
                                <strong th:text="${alertTitle}"></strong> <span th:text="${alertMessage}"></span>
                            </div>
                            
                            <input type="hidden" th:field="*{maintenance.id}" name="id">
                            
                            <div class="row g-3">
                                <!-- Columna 1 -->
                                <div class="col-md-6">
                                    <div class="form-group mb-3">
                                        <label for="maintenanceDate" class="form-label fw-bold">Fecha:</label>
                                        <input type="date" class="form-control" id="maintenanceDate" 
                                               th:field="*{maintenance.maintenanceDate}" name="maintenanceDate" required>
                                    </div>
                                    <div class="form-group mb-3">
                                        <label for="maintenanceType" class="form-label fw-bold">Tipo:</label>
                                        <select class="form-select" id="maintenanceType" 
                                                th:field="*{maintenance.maintenanceType}" name="maintenanceType" required>
                                            <option value="Preventivo">Preventivo</option>
                                            <option value="Correctivo">Correctivo</option>
                                        </select>
                                    </div>
                                </div>
                                <!-- Columna 2 -->
                                <div class="col-md-6">
                                    <div class="form-group mb-3">
                                        <label for="state" class="form-label fw-bold">Estado:</label>
                                        <select class="form-select" id="state" 
                                                th:field="*{maintenance.state}" name="state" required>
                                            <option value="Pendiente">Pendiente</option>
                                            <option value="En proceso">En proceso</option>
                                            <option value="Terminada">Terminada</option>
                                        </select>
                                    </div>
                                    <div class="form-group mb-3">
                                        <label for="priorities" class="form-label fw-bold">Prioridad:</label>
                                        <select class="form-select" id="priorities" 
                                                th:field="*{maintenance.priorities}" name="priorities" required>
                                            <option value="alta">Alta</option>
                                            <option value="media">Media</option>
                                            <option value="baja">Baja</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group mb-3">
                                <label for="description" class="form-label fw-bold">Descripción:</label>
                                <textarea class="form-control" id="description" 
                                          th:field="*{maintenance.description}" name="description" rows="3" required></textarea>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                            <button type="submit" class="btn btn-primary">Actualizar</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <script>
        // Validación del formulario
        (function() {
            'use strict';
            const form = document.getElementById('updateMaintenanceForm');
            
            form.addEventListener('submit', function(event) {
                if (!form.checkValidity()) {
                    event.preventDefault();
                    event.stopPropagation();
                }
                
                form.classList.add('was-validated');
            }, false);
        })();
        </script>
    </div>
</body>
</html>